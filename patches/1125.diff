diff --git a/CPP/7zip/UI/FileManager/ProgressDialog2.cpp b/CPP/7zip/UI/FileManager/ProgressDialog2.cpp
index 762f249..28e3eae 100644
--- a/CPP/7zip/UI/FileManager/ProgressDialog2.cpp
+++ b/CPP/7zip/UI/FileManager/ProgressDialog2.cpp
@@ -1245,11 +1245,24 @@ Hunk #5, a/CPP/7zip/UI/FileManager/ProgressDialog2.cpp void CProgressDialog::ProcessWasFinished()
 }
 
 
+static THREAD_FUNC_DECL MyThreadFunction(void *param)
+{
+  CProgressThreadVirt *p = (CProgressThreadVirt *)param;
+  try
+  {
+    p->Process();
+    p->ThreadFinishedOK = true;
+  }
+  catch (...) { p->Result = E_FAIL; }
+  return 0;
+}
+
+
 HRESULT CProgressThreadVirt::Create(const UString &title, HWND parentWindow)
 {
   NWindows::CThread thread;
   RINOK(thread.Create(MyThreadFunction, this));
-  ProgressDialog.Create(title, thread, parentWindow);
+  CProgressDialog::Create(title, thread, parentWindow);
   return S_OK;
 }
 
