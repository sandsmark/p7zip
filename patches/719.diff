diff --git a/CPP/7zip/Compress/Rar1Decoder.cpp b/CPP/7zip/Compress/Rar1Decoder.cpp
index 0a55250..6b55705 100644
--- a/CPP/7zip/Compress/Rar1Decoder.cpp
+++ b/CPP/7zip/Compress/Rar1Decoder.cpp
@@ -122,19 +122,22 @@ Hunk #4, a/CPP/7zip/Compress/Rar1Decoder.cpp HRESULT CDecoder::ShortLZ()
       return CopyBlock(dist, len);
     }
 
-    LCount = 0;
-    saveLen = len;
+    UInt32 saveLen = len;
     dist = m_RepDists[(m_RepDistPtr - (len - 9)) & 3];
-    len = DecodeNum(PosL1) + 2;
-    if (len == 0x101 && saveLen == 10)
+    
+    len = DecodeNum(PosL1);
+    
+    if (len == 0xff && saveLen == 10)
     {
-      Buf60 ^= 1;
+      Buf60 ^= 16;
       return S_OK;
     }
     if (dist >= 256)
+    {
       len++;
-    if (dist >= MaxDist3 - 1)
-      len++;
+      if (dist >= MaxDist3 - 1)
+        len++;
+    }
   }
   else
   {
