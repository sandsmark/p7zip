diff --git a/CPP/7zip/UI/FileManager/FM.mak b/CPP/7zip/UI/FileManager/FM.mak
index 6a85ea2..654da62 100644
--- a/CPP/7zip/UI/FileManager/FM.mak
+++ b/CPP/7zip/UI/FileManager/FM.mak
@@ -1,3 +1,16 @@ Hunk #1, a/CPP/7zip/UI/FileManager/FM.mak
+CFLAGS = $(CFLAGS) \
+  -DLANG \
+  -DNEW_FOLDER_INTERFACE \
+
+!IFDEF UNDER_CE
+LIBS = $(LIBS) ceshell.lib Commctrl.lib
+!ELSE
+LIBS = $(LIBS) comctl32.lib htmlhelp.lib comdlg32.lib Mpr.lib Gdi32.lib
+CFLAGS = $(CFLAGS) -DWIN_LONG_PATH -DSUPPORT_DEVICE_FILE
+LFLAGS = $(LFLAGS) /DELAYLOAD:mpr.dll 
+LIBS = $(LIBS) delayimp.lib 
+!ENDIF
+
 FM_OBJS = \
   $O\App.obj \
   $O\BrowseDialog.obj \
